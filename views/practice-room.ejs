<html>
  <head>
    <!-- Stylesheets in here -->
    <% include ./partials/head %>
    <link rel="stylesheet" href="/stylesheets/practice-room.css">
    <script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script>
    <script src="/javascripts/aframe-physics-system.min.js"></script>
    <script src="/javascripts/aframe-extras.min.js"></script>
    <script src="/javascripts/socket.io.min.js"></script>
    <script src="/javascripts/easyrtc.js"></script>
    <script src="/javascripts/networked-aframe.min.js"></script>
    <script src="/javascripts/super-hands.min.js"></script>
    <script src="/javascripts/tt-ball.js"></script>
    <script>
        var currentRoom = <%- '"' + roomName + '"'%>;

        function onConnect() {
            console.log("OnConnect");
        }

        NAF.schemas.add({
          template: '#avatar-template',
          components: [
            'position',
            'rotation',
            {
              selector: '.head',
              component: 'material',
              property: 'color'
            }
          ]
        });
      </script>
  </head>
  <body>
      <% include ./partials/modal %>
      <a-scene hidden id="game" networked-scene=<%- '"app:techniquexr; room:' + roomName + '; adapter:easyrtc; audio:true;"'%>>
      <a-assets>
        <a-asset-item id="tt-table-model" src="/models/tt-table.gltf"></a-asset-item>
        <a-asset-item id="tt-racket-model" src="/models/tt-racket.gltf"></a-asset-item>

        <!-- Templates -->

        <!-- Avatar -->
        <script id="avatar-template" type="text/html">
          <a-entity class="avatar" networked-audio-source="positional:false">
            <a-sphere class="head"
              color="#5985ff"
              scale="0.45 0.5 0.4"
              random-color
            ></a-sphere>
            <a-entity class="face"
              position="0 0.05 0"
            >
              <a-sphere class="eye"
                color="#efefef"
                position="0.16 0.1 -0.35"
                scale="0.12 0.12 0.12"
              >
                <a-sphere class="pupil"
                  color="#000"
                  position="0 0 -1"
                  scale="0.2 0.2 0.2"
                ></a-sphere>
              </a-sphere>
              <a-sphere class="eye"
                color="#efefef"
                position="-0.16 0.1 -0.35"
                scale="0.12 0.12 0.12"
              >
                <a-sphere class="pupil"
                  color="#000"
                  position="0 0 -1"
                  scale="0.2 0.2 0.2"
                ></a-sphere>
              </a-sphere>
            </a-entity>
          </a-entity>
        </script>
        <!-- /Templates -->
      </a-assets>

      <a-entity id="player"  progressive-controls movement-controls>
          <a-entity id="player-camera" networked="template:#avatar-template;showLocalTemplate:false;" camera look-controls></a-entity>
          <a-entity id="right-hand"  class="right-controller"></a-entity>
          <a-entity id="left-hand" class="left-controller"></a-entity>
      </a-entity>

      <a-entity static-body gltf-model="#tt-table-model" position = "0 0 2"></a-entity>

      <a-entity gltf-model="#tt-racket-model" grabbable dynamic-body="mass: 1" position="0 2 2"></a-entity>
      <a-entity gltf-model="#tt-racket-model" grabbable dynamic-body="mass: 1" position="0 2 2"></a-entity>
      <a-entity gltf-model="#tt-racket-model" grabbable dynamic-body="mass: 1" position="0 2 2"></a-entity>
      <a-entity gltf-model="#tt-racket-model" grabbable dynamic-body="mass: 1" position="0 2 2"></a-entity>

      <a-sphere dynamic-body="mass: 0.1" color="#ffffff" tt-ball scale="0.03 0.03 0.03"></a-sphere>

      <a-entity static-body 
        geometry="primitive: plane; width: 10000; height: 10000;" rotation="-90 0 0"></a-entity>

      <a-entity light="color: #ffffff; intensity: 0.01; type: ambient;" visible=""></a-entity>
      <a-entity id = "sceneLight" light="color: #ffffff; intensity: 0.02" position="5 5 5"></a-entity>

      <a-sky color="#ffffff"></a-sky>
    </a-scene>

    <footer>
      <!-- Scripts throw in here -->
      <% include ./partials/footer %>
      <script src="/javascripts/lobby.js"></script>
    </footer>
  </body>
</html>
